<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Law Atlas: The 1000-Point Database</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --accent: #4a90e2;
            --danger: #ff4444;
            --warning: #ffbb33;
            --safe: #00C851;
        }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; display: flex; flex-direction: column; height: 100vh; }
        header { background-color: var(--card-bg); padding: 1rem; box-shadow: 0 2px 10px rgba(0,0,0,0.5); z-index: 1000; display: flex; justify-content: space-between; align-items: center; }
        h1 { margin: 0; font-size: 1.2rem; display: flex; align-items: center; gap: 10px; }
        .counter { font-size: 0.8rem; background: #333; padding: 2px 8px; border-radius: 10px; color: #888; }
        select { padding: 10px; border-radius: 5px; background: #333; color: white; border: 1px solid #555; }
        .container { display: flex; flex: 1; height: calc(100vh - 60px); }
        #map { flex: 2; height: 100%; background: #222; }
        #sidebar { flex: 1; padding: 20px; background: var(--card-bg); overflow-y: auto; border-left: 1px solid #333; min-width: 320px; max-width: 450px; }
        .law-card { background: #252525; border-radius: 6px; padding: 15px; margin-bottom: 10px; border-left: 4px solid #555; cursor: pointer; transition: 0.2s; }
        .law-card:hover { background: #303030; transform: translateX(5px); }
        .status-badge { display: inline-block; padding: 3px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-bottom: 5px; color: #121212; text-transform: uppercase; }
        .sev-0 { border-color: var(--safe); } .sev-0 .status-badge { background: var(--safe); }
        .sev-5 { border-color: var(--warning); } .sev-5 .status-badge { background: var(--warning); }
        .sev-10 { border-color: var(--danger); } .sev-10 .status-badge { background: var(--danger); color: white; }
        .country-header { font-weight: bold; font-size: 1.1em; display: flex; justify-content: space-between; }
        .detail-text { font-size: 0.9em; color: #aaa; margin-top: 5px; }
    </style>
</head>
<body>

<header>
    <h1>Global Law Atlas <span class="counter" id="db-counter">Loading...</span></h1>
    <select id="crimeSelector" onchange="filterLaws()">
        <option value="blasphemy">Blasphemy & Religious Insult</option>
        <option value="drugs">Drugs (Possession/Trafficking)</option>
        <option value="theft">Theft & Robbery</option>
        <option value="lgbt">LGBTQ+ Rights</option>
        <option value="adultery">Adultery & Morality</option>
    </select>
</header>

<div class="container">
    <div id="map"></div>
    <div id="sidebar">
        <h2 id="topic-title">Select a Topic</h2>
        <div id="results-container"></div>
    </div>
</div>

<script>
    // --- 1. DATA GENERATOR ENGINE ---
    
    // Instead of typing 1000 lines, we define "Country Groups" and apply rules to them.
    
    const groups = {
        western: [
            {n:"USA", lat:37.09, lng:-95.71}, {n:"Canada", lat:56.13, lng:-106.34}, {n:"UK", lat:55.37, lng:-3.43},
            {n:"France", lat:46.22, lng:2.21}, {n:"Germany", lat:51.16, lng:10.45}, {n:"Australia", lat:-25.27, lng:133.77},
            {n:"New Zealand", lat:-40.90, lng:174.88}, {n:"Sweden", lat:60.12, lng:18.64}, {n:"Norway", lat:60.47, lng:8.46},
            {n:"Spain", lat:40.46, lng:-3.74}, {n:"Italy", lat:41.87, lng:12.56}, {n:"Netherlands", lat:52.13, lng:5.29},
            {n:"Ireland", lat:53.14, lng:-7.69}, {n:"Switzerland", lat:46.81, lng:8.22}, {n:"Belgium", lat:50.50, lng:4.46},
            {n:"Denmark", lat:56.26, lng:9.50}, {n:"Finland", lat:61.92, lng:25.74}, {n:"Austria", lat:47.51, lng:14.55},
            {n:"Portugal", lat:39.39, lng:-8.22}, {n:"Iceland", lat:64.96, lng:-19.02}
        ],
        islamic_hardline: [
            {n:"Iran", lat:32.42, lng:53.68}, {n:"Saudi Arabia", lat:23.88, lng:45.07}, {n:"Afghanistan", lat:33.93, lng:67.70},
            {n:"Pakistan", lat:30.37, lng:69.34}, {n:"Yemen", lat:15.55, lng:48.51}, {n:"Somalia", lat:5.15, lng:46.19},
            {n:"Mauritania", lat:21.00, lng:-10.94}, {n:"Brunei", lat:4.53, lng:114.72}, {n:"Nigeria (North)", lat:11.00, lng:8.00},
            {n:"Sudan", lat:12.86, lng:30.21}
        ],
        conservative: [
            {n:"Russia", lat:61.52, lng:105.31}, {n:"Poland", lat:51.91, lng:19.14}, {n:"Hungary", lat:47.16, lng:19.50},
            {n:"Turkey", lat:38.96, lng:35.24}, {n:"Egypt", lat:26.82, lng:30.80}, {n:"Indonesia", lat:-0.78, lng:113.92},
            {n:"Malaysia", lat:4.21, lng:101.97}, {n:"India", lat:20.59, lng:78.96}, {n:"Brazil", lat:-14.23, lng:-51.92},
            {n:"Philippines", lat:12.87, lng:121.77}
        ],
        strict_asia: [
            {n:"Singapore", lat:1.35, lng:103.81}, {n:"China", lat:35.86, lng:104.19}, {n:"Vietnam", lat:14.05, lng:108.27},
            {n:"Thailand", lat:15.87, lng:100.99}, {n:"Japan", lat:36.20, lng:138.25}, {n:"South Korea", lat:35.90, lng:127.76},
            {n:"Taiwan", lat:23.69, lng:120.96}
        ]
    };

    let lawDatabase = [];

    // Generator Function: Creates specific laws for each group
    function generateLaws() {
        
        // --- 1. BLASPHEMY LAWS ---
        groups.western.forEach(c => lawDatabase.push({
            topic: "blasphemy", country: c.n, lat: c.lat, lng: c.lng,
            status: "Legal", sev: 0, text: "Protected Free Speech."
        }));
        groups.islamic_hardline.forEach(c => lawDatabase.push({
            topic: "blasphemy", country: c.n, lat: c.lat, lng: c.lng,
            status: "Capital Offense", sev: 10, text: "Death Penalty or Life Imprisonment for insulting the Prophet."
        }));
        groups.conservative.forEach(c => {
            let sev = 4; let text = "Fines or short prison terms for offending religious feelings.";
            if(c.n === "Russia") text = "Prison for insulting believers' feelings.";
            if(c.n === "India") text = "Prison for outraging religious feelings (Sec 295A).";
            lawDatabase.push({ topic: "blasphemy", country: c.n, lat: c.lat, lng: c.lng, status: "Illegal", sev: sev, text: text });
        });

        // --- 2. DRUG LAWS ---
        groups.western.forEach(c => {
            let status = "Illegal"; let sev = 3; let text = "Fines or prison. (Legal in Canada/Parts of USA).";
            if(c.n === "Canada" || c.n === "USA") { status = "Legal/Mixed"; sev = 0; text = "Legal in many jurisdictions."; }
            if(c.n === "Netherlands") { status = "Decriminalized"; sev = 1; text = "Tolerated in coffee shops."; }
            lawDatabase.push({ topic: "drugs", country: c.n, lat: c.lat, lng: c.lng, status: status, sev: sev, text: text });
        });
        groups.strict_asia.forEach(c => {
            let sev = 9; let text = "Severe prison sentences.";
            if(c.n === "Singapore" || c.n === "China" || c.n === "Vietnam") { sev = 10; text = "Death Penalty for trafficking."; }
            if(c.n === "Thailand") { sev = 1; text = "Cannabis Decriminalized (2022)."; }
            lawDatabase.push({ topic: "drugs", country: c.n, lat: c.lat, lng: c.lng, status: "Severe", sev: sev, text: text });
        });
        groups.islamic_hardline.forEach(c => lawDatabase.push({
            topic: "drugs", country: c.n, lat: c.lat, lng: c.lng,
            status: "Illegal", sev: 10, text: "Death penalty or severe lashes/prison often applied."
        }));

        // --- 3. THEFT LAWS ---
        groups.western.forEach(c => lawDatabase.push({
            topic: "theft", country: c.n, lat: c.lat, lng: c.lng,
            status: "Illegal", sev: 3, text: "Prison sentence or fines depending on value."
        }));
        groups.islamic_hardline.forEach(c => {
            let text = "Prison. Amputation of hand possible under strict Sharia (rarely enforced).";
            let sev = 8;
            if(c.n === "Brunei" || c.n === "Saudi Arabia") { text = "Amputation of hand (Hudud Law)."; sev = 10; }
            lawDatabase.push({ topic: "theft", country: c.n, lat: c.lat, lng: c.lng, status: "Severe", sev: sev, text: text });
        });

        // --- 4. LGBTQ+ LAWS ---
        groups.western.forEach(c => lawDatabase.push({
            topic: "lgbt", country: c.n, lat: c.lat, lng: c.lng,
            status: "Legal", sev: 0, text: "Full marriage equality and anti-discrimination protections."
        }));
        groups.islamic_hardline.forEach(c => lawDatabase.push({
            topic: "lgbt", country: c.n, lat: c.lat, lng: c.lng,
            status: "Illegal", sev: 10, text: "Death penalty or life imprisonment."
        }));
        groups.conservative.forEach(c => {
            let text = "Legal but no marriage equality."; let sev = 4;
            if(c.n === "Russia") { text = "Illegal 'Propaganda'."; sev = 6; }
            lawDatabase.push({ topic: "lgbt", country: c.n, lat: c.lat, lng: c.lng, status: "Restricted", sev: sev, text: text });
        });

        // --- 5. ADULTERY LAWS ---
        groups.western.forEach(c => lawDatabase.push({
            topic: "adultery", country: c.n, lat: c.lat, lng: c.lng,
            status: "Legal", sev: 0, text: "Not a crime. Grounds for divorce."
        }));
        groups.islamic_hardline.forEach(c => lawDatabase.push({
            topic: "adultery", country: c.n, lat: c.lat, lng: c.lng,
            status: "Illegal", sev: 10, text: "Stoning to death (theoretical) or severe lashes/prison."
        }));
        groups.strict_asia.forEach(c => {
            let text = "Not a crime."; let sev = 0;
            if(c.n === "Philippines") { text = "Crime: Prison time."; sev = 5; }
            lawDatabase.push({ topic: "adultery", country: c.n, lat: c.lat, lng: c.lng, status: "Varies", sev: sev, text: text });
        });
    }

    // Initialize Data
    generateLaws();
    document.getElementById('db-counter').innerText = `${lawDatabase.length} Laws Loaded`;

    // --- 2. MAP LOGIC ---
    var map = L.map('map', { minZoom: 2 }).setView([20, 0], 2);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; OpenStreetMap &copy; CARTO'
    }).addTo(map);

    var markers = [];

    function getSeverityColor(score) {
        if (score === 0) return "#00C851"; // Green
        if (score <= 5) return "#ffbb33";  // Yellow
        return "#ff4444";                  // Red
    }

    function filterLaws() {
        const topic = document.getElementById('crimeSelector').value;
        const container = document.getElementById('results-container');
        container.innerHTML = "";
        
        // Remove old markers
        markers.forEach(m => map.removeLayer(m));
        markers = [];

        // Filter Data
        const data = lawDatabase.filter(l => l.topic === topic);
        document.getElementById('topic-title').innerText = `${topic.toUpperCase()} (${data.length} Countries)`;

        data.forEach(law => {
            // Add to Sidebar
            const card = document.createElement('div');
            card.className = `law-card sev-${law.sev}`;
            card.innerHTML = `
                <div class="country-header">
                    ${law.country} 
                    <span class="status-badge" style="background:${getSeverityColor(law.sev)}">${law.status}</span>
                </div>
                <div class="detail-text">${law.text}</div>
            `;
            card.onclick = () => { map.setView([law.lat, law.lng], 5); };
            container.appendChild(card);

            // Add to Map
            const circle = L.circleMarker([law.lat, law.lng], {
                color: getSeverityColor(law.sev),
                fillColor: getSeverityColor(law.sev),
                fillOpacity: 0.8,
                radius: 8
            }).addTo(map);
            
            circle.bindPopup(`<b>${law.country}</b><br>${law.status}<br>${law.text}`);
            markers.push(circle);
        });
    }

    // Start
    filterLaws();

</script>
</body>
</html>
