<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mothman Final Tracker</title>
    <style>
        :root {
            --pip-green: #1eff00;
            --pip-dim: #124d06;
            --pip-alert: #ff3333;
            --bg-color: #0d110d;
        }

        body {
            background-color: var(--bg-color);
            color: var(--pip-green);
            font-family: "Courier New", Courier, monospace;
            margin: 0;
            padding: 15px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            -webkit-user-select: none;
            user-select: none;
        }

        /* CRT Scanline Overlay */
        body::after {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 10;
            opacity: 0.3;
        }

        header {
            text-align: center;
            border-bottom: 2px solid var(--pip-green);
            padding-bottom: 10px;
            margin-bottom: 10px;
            flex-shrink: 0;
            z-index: 11;
        }

        h1 { margin: 0; font-size: 1.2rem; letter-spacing: 2px; }

        .main-layout {
            display: flex;
            flex: 1;
            gap: 15px;
            overflow: hidden;
            z-index: 11;
        }

        /* LEFT COLUMN: BUTTONS */
        .card-grid {
            flex: 1.2;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            overflow-y: auto;
            padding-bottom: 40px; /* Space for scrolling */
        }

        .toggle-btn {
            background: rgba(0, 20, 0, 0.6);
            border: 1px solid var(--pip-dim);
            color: var(--pip-dim);
            padding: 10px;
            font-family: inherit;
            font-size: 0.75rem;
            font-weight: bold;
            text-align: left;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 55px;
            transition: 0.1s;
        }

        .toggle-btn.active {
            border-color: var(--pip-green);
            background-color: var(--pip-green);
            color: black;
            box-shadow: 0 0 8px var(--pip-green);
        }

        .toggle-btn small {
            font-size: 0.6rem;
            margin-top: 3px;
            opacity: 0.7;
            font-weight: normal;
        }

        /* RIGHT COLUMN: READOUT */
        .rules-panel {
            flex: 2;
            border: 2px solid var(--pip-green);
            background: rgba(0, 10, 0, 0.8);
            padding: 10px;
            display: flex;
            flex-direction: column;
            border-radius: 6px;
        }

        #alert-box {
            display: none;
            background: rgba(50, 0, 0, 0.6);
            border: 1px solid var(--pip-alert);
            color: var(--pip-alert);
            padding: 10px;
            margin-bottom: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .rules-title {
            text-decoration: underline;
            margin-bottom: 10px;
            font-weight: bold;
            text-align: center;
            font-size: 0.9rem;
        }

        #rules-list {
            flex: 1;
            overflow-y: auto;
            list-style: none;
            padding: 0;
            margin: 0;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        #rules-list li {
            margin-bottom: 10px;
            padding-left: 10px;
            border-left: 2px solid var(--pip-green);
        }
    </style>
</head>
<body>

<header>
    <h1>PIP-BOY: ULTIMATE</h1>
</header>

<div class="main-layout">
    <div class="card-grid" id="cardGrid">
        </div>

    <div class="rules-panel">
        <div id="alert-box"></div>
        <div class="rules-title">ACTIVE BOARD STATE</div>
        <ul id="rules-list">
            <li style="border:none; opacity:0.5;">> Select active cards...</li>
        </ul>
    </div>
</div>

<script>
    // The Complete List of Board-Affecting Cards
    const database = [
        { name: "The Wise Mothman", type: "Commander", text: "Attack: Give Rads to defender. <br>Mill Trigger: Distribute X +1/+1 counters." },
        { name: "Bruvac the Grandiloquent", type: "Replacement", text: "Opponents mill DOUBLE cards." },
        { name: "The Mindskinner", type: "Replacement", text: "Prevent combat dmg -> They MILL that much instead." },
        { name: "Bloodchief Ascension", type: "Enchantment", text: "(Needs 3 counters) Card hits opp GY -> They lose 2 life, you gain 2." },
        { name: "Mindcrank", type: "Artifact", text: "Opponent loses life -> They mill that many cards." },
        { name: "Syr Konrad, the Grim", type: "Creature", text: "Creature dies OR creature milled -> 1 dmg to each opponent." },
        { name: "Mesmeric Orb", type: "Artifact", text: "Untap -> Mill 1." },
        { name: "Dictate of Erebos", type: "Enchantment", text: "Your creature dies -> They sac a creature." },
        { name: "Zellix, Sanity Flayer", type: "Creature", text: "Mill creature -> Create 1/1 Horror." },
        { name: "Consuming Aberration", type: "Trigger", text: "Cast spell -> Grind to land." },
        { name: "Screeching Scorchbeast", type: "Creature", text: "Upkeep -> Give 2 Rads." },
        { name: "Glowing One", type: "Creature", text: "Dies -> Give 4 Rads." },
        { name: "Struggle for Project Purity", type: "Enchantment", text: "Draw card -> Give 1 Rad." },
        { name: "Mariposa Military Base", type: "Land", text: "Attack -> Give 1 Rad." },
        { name: "The Master, Transcendent", type: "Creature", text: "ETB -> Give 2 Rads." },
        { name: "Bloatfly Swarm", type: "Creature", text: "Damage -> Give Rads." },
        { name: "Vault 12: The Necropolis", type: "Saga", text: "Level 1: Give Rads. Level 2: Create Tokens." },
        { name: "Codex Shredder", type: "Artifact", text: "Tap: Target player mills 1." },
        { name: "Nesting Grounds", type: "Land", text: "Sorcery Speed: Move a counter from one permanent to another (Can give Rads)." },
        { name: "Evolution Sage", type: "Proliferate", text: "Landfall -> Multiply Rads." },
        { name: "Flux Channeler", type: "Proliferate", text: "Cast Noncreature -> Multiply Rads." },
        { name: "Inexorable Tide", type: "Proliferate", text: "Cast Spell -> Multiply Rads." },
        { name: "Thrummingbird", type: "Proliferate", text: "Hit Player -> Multiply Rads." }
    ];

    const grid = document.getElementById('cardGrid');
    const list = document.getElementById('rules-list');
    const alertBox = document.getElementById('alert-box');
    
    let activeIndices = new Set();

    database.forEach((card, index) => {
        const btn = document.createElement('button');
        btn.className = 'toggle-btn';
        btn.innerHTML = `<span>${card.name}</span><small>${card.type}</small>`;
        btn.onclick = () => toggle(index, btn);
        grid.appendChild(btn);
    });

    function toggle(index, btn) {
        if (activeIndices.has(index)) {
            activeIndices.delete(index);
            btn.classList.remove('active');
        } else {
            activeIndices.add(index);
            btn.classList.add('active');
        }
        render();
    }

    function render() {
        list.innerHTML = '';
        alertBox.style.display = 'none';
        alertBox.innerHTML = '';
        
        if (activeIndices.size === 0) {
            list.innerHTML = '<li style="border:none; opacity:0.5;">> Select active cards...</li>';
            return;
        }

        let alerts = [];
        let activeNames = [];

        // 1. Render List & Collect Names
        activeIndices.forEach(idx => {
            const card = database[idx];
            activeNames.push(card.name);
            const li = document.createElement('li');
            li.innerHTML = `<strong>${card.name}:</strong> ${card.text}`;
            list.appendChild(li);
        });

        // 2. CHECK COMBOS
        const has = (name) => activeNames.includes(name);

        // Infinite Kill: Bloodchief + Mindcrank
        if (has("Bloodchief Ascension") && has("Mindcrank")) {
            alerts.push("⚠️ INFINITE COMBO: Bloodchief + Mindcrank. (If Ascension is active: Life Loss causes Mill, Mill triggers Life Loss. Repeats until win.)");
        }

        // Interaction: Bruvac + Mindskinner
        if (has("Bruvac the Grandiloquent") && has("The Mindskinner")) {
            alerts.push("⚠️ COMBAT ALERT: Combat Damage Prevented. Opponents mill DOUBLE the intended damage.");
        }

        // Chain Reaction: Syr Konrad + Mindcrank
        if (has("Syr Konrad, the Grim") && has("Mindcrank")) {
            alerts.push("⚠️ SYNERGY ALERT: Konrad Dmg triggers Mindcrank Mill. If Creature milled -> Konrad triggers again.");
        }

        // Interaction: Bruvac + Rads
        const radProducers = ["The Wise Mothman", "Screeching Scorchbeast", "Glowing One", "Struggle for Project Purity", "Mariposa Military Base", "The Master, Transcendent", "Bloatfly Swarm", "Vault 12: The Necropolis"];
        const hasRads = radProducers.some(r => has(r));
        
        if (has("Bruvac the Grandiloquent") && hasRads) {
             alerts.push("⚠️ RAD ALERT: Bruvac is active. Radiation triggers mill 2 cards per counter instead of 1.");
        }

        // Display Alerts
        if (alerts.length > 0) {
            alertBox.style.display = 'block';
            alertBox.innerHTML = alerts.join('<br><br>');
        }
    }
</script>

</body>
</html>
