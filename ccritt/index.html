<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CryptoCritterz â€” Status-Only Dev Menu</title>
  <style>
    html, body {
      margin: 0; padding: 0; width: 100vw; height: 100vh; background: #191d26;
    }
    body {
      width: 100vw; height: 100vh; min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      background: linear-gradient(180deg, #262d41 0%, #322b3f 75%, #1e1b20 100%);
      overflow: hidden;
    }
    #scene {
      width: 860px; height: 540px; max-width: 96vw; max-height: 98vh;
      position: relative; background: #232733; border-radius: 26px;
      box-shadow: 0 30px 80px #000a, 0 2px 24px #0a191944;
      overflow: hidden; display: flex; align-items: flex-end; justify-content: center;
      border: 4px solid #18151a;
      user-select: none;
      -webkit-user-select: none;
    }
    #wallpaper {
      position: absolute; top: 0; left: 0; width: 100%; height: 67%;
      background: url('img/wallpaper/your_wallpaper.png') repeat;
      background-size: 150px 150px; opacity: .14;
      filter: blur(2.2px) brightness(1.23) grayscale(.09); z-index: 1;
    }
    #wall-grad {
      position: absolute; top: 0; left: 0; width: 100%; height: 68%;
      background: linear-gradient(180deg, #494c62 0%, #2e2338 84%, #171921 100%);
      z-index: 2;
    }
    #ceiling {
      position: absolute; top: 0; left: 0; width: 100%; height: 11%;
      background: linear-gradient(180deg,#bfc7df99 78%,#8e80aa55 100%);
      transform: perspective(1000px) rotateX(-17deg) scaleY(.77);
      z-index: 4; opacity: .94;
      box-shadow: 0 17px 24px #0002 inset;
    }
    #floor {
      position: absolute; bottom: 0; left: 0; width: 100%; height: 30%;
      background: linear-gradient(110deg,#cdb896 53%,#d6bf9f 90%, #b09e86 100%);
      transform: perspective(1220px) rotateX(19deg) scaleY(1.19);
      z-index: 6;
      box-shadow: 0 -25px 58px #0007 inset, 0 12px 36px #0004;
    }
    #floor-shadow {
      position: absolute; bottom: 14%; left: 50%; width: 54%; height: 15%;
      background: radial-gradient(ellipse at center, #0004 0%, #0000 90%);
      transform: translateX(-50%) scaleY(.73);
      z-index: 10; pointer-events: none; opacity: .16;
    }
    /* -- TV styling -- */
    #tv-block {
      position: absolute; left: 100px; bottom: 118px; width: 264px; height: 245px; z-index: 22;
      display: flex; flex-direction: column; align-items: center; justify-content: flex-end;
      pointer-events: none;
    }
    #tv {
      width: 240px; height: 188px;
      background: linear-gradient(180deg, #232d36 64%, #181e23 100%);
      border: 13px solid #191b1d;
      border-radius: 15px 15px 26px 26px / 13px 13px 30px 30px;
      box-shadow: 0 12px 50px #0099ff44, 0 2px 8px #181c23;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      position: relative; overflow: visible;
      filter: drop-shadow(0 2px 16px #15f8e299);
    }
    #tv-glass {
      position: absolute; left: 16px; top: 17px; width: 205px; height: 38px; z-index: 3;
      background: linear-gradient(90deg,rgba(255,255,255,0.14) 0%,rgba(170,220,255,0.07) 98%);
      border-radius: 13px 12px 20px 18px;
      filter: blur(1.7px); pointer-events: none; opacity: .30;
    }
    #tv-screen {
      width: 186px; height: 116px; background: #151a1f;
      border-radius: 13px; margin: 36px auto 7px; position: relative;
      box-shadow: 0 1px 23px #0ffff722,0 0 3px #233, 0 0 42px #0099ff18;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      border: 3px solid #17c9ce37;
      z-index: 1; overflow: hidden;
    }
    #scanlines {
      pointer-events: none;
      position: absolute; left: 0; top: 0; width: 100%; height: 100%; z-index: 5;
      background: repeating-linear-gradient(
        to bottom, rgba(255,255,255,0.08) 0px, rgba(255,255,255,0.01) 3px,
        rgba(0,0,0,0.05) 7px, rgba(0,0,0,0.01) 13px
      );
      opacity: .21; mix-blend-mode: lighten;
    }
    #btcPrice {
      color: #38ffe4; font-size: 1.21rem; font-family: monospace;
      font-weight: 700; text-shadow: 0 2px 9px #00c9c7a4, 0 0 1px #222;
      margin: 7px 0 11px 0; letter-spacing: 1.1px; transition: color .16s;
    }
    #btcChart {
      width: 148px; height: 35px; cursor: pointer; border-radius: 5px;
      margin: 0 0 0 0; background: #181a18;
      box-shadow: 0 0 11px #00c9f266, 0 0 2px #222;
      border: 1px solid #19f8d433;
      display: block;
    }
    #chartError {
      display:none;
      color:#ec7063; font-size:.98rem; margin-top:9px; text-align:center;
      text-shadow:0 1px 4px #0009;
      font-family:monospace; padding:6px 0 0 0;
    }
    #tv-feet {
      position: absolute; bottom: -22px; left: 18px; width: 86%; height: 18px; z-index: 1;
      display: flex; justify-content: space-between; pointer-events: none;
    }
    .tv-leg {
      width: 27px; height: 18px;
      background: linear-gradient(180deg, #343a42 68%, #171a19 100%);
      border-radius: 9px 9px 12px 12px;
      box-shadow: 0 7px 12px #0008;
      border: 2px solid #161a1b; opacity: .77;
    }
    #tv-led {
      position: absolute; bottom: 12px; left: 51%; transform: translateX(-50%);
      width: 11px; height: 11px; background: #0aff98; border-radius: 50%;
      box-shadow: 0 0 13px 4px #0aff9842; opacity: .91;
    }
    /* Critter Zone */
    #critter-zone {
      position: absolute; left: 435px; bottom: 142px; width: 190px; height: 180px; z-index: 26;
      display: flex; align-items: flex-end; justify-content: center; pointer-events: none;
    }
    #critterImg {
      width: 140px; height: 140px; image-rendering: pixelated;
      pointer-events: auto; user-select: none; transition: transform .16s;
      filter: drop-shadow(0 14px 16px #262a2a32);
    }
    #critterImg:active {
      transform: translateY(-28px) scale(1.1) rotate(-7deg);
      filter: drop-shadow(0 24px 25px #00cfcf38);
    }
    #critter-shadow {
      position: absolute; left: 57px; bottom: 13px; width: 45px; height: 16px; z-index: 14;
      background: radial-gradient(ellipse at center,#0005 0%,#0000 90%);
      opacity: .28; filter: blur(2.3px);
    }
    #evolutionMsg {
      position: absolute; top: 17px; left: 42px; z-index: 100;
      background: #19253ecd; color: #ffc; font-size: 1.09rem;
      padding: 7px 20px; border-radius: 9px; border: 1px solid #333;
      box-shadow: 0 2px 13px #000c; display: none; font-family: monospace;
    }
    /* Critter Picker */
    #critterPicker {
      position: absolute;
      right: 18px; bottom: 26px; z-index: 99;
      display: flex; gap: 11px;
      background: rgba(25,29,38,.54);
      border-radius: 13px;
      padding: 7px 12px 6px 12px;
      box-shadow: 0 3px 14px #0005;
      align-items: center;
    }
    .picker-thumb {
      width: 44px; height: 44px; object-fit: contain;
      background: #262d34;
      border: 2.6px solid #424851;
      border-radius: 10px;
      cursor: pointer;
      transition: border .18s, box-shadow .18s;
      box-shadow: 0 3px 11px #0015;
      outline: none;
    }
    .picker-thumb.selected {
      border: 2.8px solid #00ffd6;
      box-shadow: 0 0 0 2.5px #00ffd67c, 0 4px 19px #13e6d950;
      z-index: 2;
    }
    .picker-thumb:active {
      filter: brightness(1.17) drop-shadow(0 1px 5px #0af5);
      border-color: #fff4b1;
    }
    /* DEV MENU */
    #devMenu {
      position: fixed; left: 0; top: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.68); z-index: 9999; display: flex; align-items: center; justify-content: center;
    }
    #devMenuInner {
      background: #232942;
      color: #eaffff;
      border-radius: 14px;
      padding: 34px 38px 24px 38px;
      box-shadow: 0 10px 42px #000e, 0 2px 8px #0ff3;
      font-family: monospace;
      min-width: 220px;
    }
    #devMenuInner h3 {
      margin-top:0;
      font-size: 1.28rem;
      letter-spacing:.06em;
      color: #44ffd9;
      margin-bottom: 13px;
    }
    .dev-btn-row {
      margin-bottom: 0;
      display: flex;
      flex-wrap: wrap;
      gap: 11px 0;
    }
    .dev-btn {
      background: #2df0e1;
      color: #222;
      font-family: monospace;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      margin: 0 9px 7px 0;
      padding: 9px 17px;
      box-shadow: 0 2px 11px #11fffa45, 0 0 2px #191a;
      cursor: pointer;
      transition: background .17s, color .17s;
      outline: none;
      font-weight: bold;
      display: inline-block;
    }
    .dev-btn:active {
      background: #19d9a9;
      color: #fff;
    }
    /* gear icon (top right) */
    #devGear {
      position: absolute;
      top: 12px; right: 12px;
      width: 32px; height: 32px;
      z-index: 200;
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      opacity: 0.62;
      transition: opacity .18s, filter .18s;
      filter: drop-shadow(0 2px 7px #00f6) drop-shadow(0 0px 1px #0009);
    }
    #devGear:hover, #devGear:active {
      opacity: 1;
      filter: drop-shadow(0 3px 15px #44ffe4a9) brightness(1.1);
    }
    #devGear svg {
      width: 100%; height: 100%;
      display: block;
      fill: #aefaf8;
      stroke: #77fff6;
      stroke-width: 1.7;
    }
    @media (max-width: 900px) {
      #scene { width:98vw; height:59vw; min-width:290px; min-height:360px; }
    }
    @media (max-width: 600px) {
      #scene { width:99vw; height:87vw; min-width:230px; min-height:320px; border-radius: 0; border-width: 2px; }
      #tv-block { left: 2vw !important; bottom: 18vw !important; width: 180px !important; height: 120px !important; }
      #tv { width: 150px !important; height: 95px !important; border-width: 7px; }
      #tv-glass { left: 7px !important; top: 8px !important; width: 120px !important; height: 17px !important; }
      #tv-screen { width: 94px !important; height: 53px !important; border-radius: 7px !important; margin: 12px auto 5px !important; }
      #btcChart { width: 71px !important; height: 18px !important; }
      #btcPrice { font-size: .8rem !important; }
      .tv-leg { width: 10px !important; height: 6px !important; }
      #tv-led { width: 7px !important; height: 7px !important; bottom: 5px !important;}
      #critter-zone { left: 52vw !important; bottom: 18vw !important; width: 70px !important; height: 90px !important; }
      #critterImg { width: 60px !important; height: 60px !important; }
      #critter-shadow { left: 14px !important; width: 19px !important; height: 7px !important;}
      #critterPicker { right: 8vw !important; bottom: 5vw !important; padding: 3px 8px 3px 8px; gap: 7px; }
      .picker-thumb { width: 30px !important; height: 30px !important; border-radius: 6px !important; }
      #devGear { top: 6px; right: 6px; width: 26px; height: 26px; }
    }
  </style>
</head>
<body>
  <div id="scene">
    <div id="wallpaper"></div>
    <div id="wall-grad"></div>
    <div id="ceiling"></div>
    <div id="floor"></div>
    <div id="floor-shadow"></div>
    <!-- TV Block: TV, feet, LED -->
    <div id="tv-block">
      <div id="tv">
        <div id="tv-glass"></div>
        <div id="tv-screen">
          <div id="btcPrice">Loading...</div>
          <img id="btcChart" src="" title="Tap for more stats" />
          <div id="scanlines"></div>
          <div id="chartError">No chart available</div>
        </div>
        <div id="tv-led"></div>
      </div>
      <div id="tv-feet">
        <div class="tv-leg"></div>
        <div class="tv-leg"></div>
      </div>
    </div>
    <!-- Critter -->
    <div id="critter-zone">
      <img id="critterImg" src="img/critter1/balanced_1_1.png" draggable="false" title="Click me!"/>
      <div id="critter-shadow"></div>
    </div>
    <div id="evolutionMsg"></div>
    <!-- Critter Picker -->
    <div id="critterPicker">
      <img class="picker-thumb" id="thumb-critter1" src="img/critter1/icon.png" title="Critter 1" onclick="selectCritter(0)">
      <img class="picker-thumb" id="thumb-critter2" src="img/critter2/icon.png" title="Critter 2" onclick="selectCritter(1)">
      <img class="picker-thumb" id="thumb-critter3" src="img/critter3/icon.png" title="Critter 3" onclick="selectCritter(2)">
    </div>
    <!-- DEV MENU -->
    <div id="devMenu" style="display:none;">
      <div id="devMenuInner">
        <h3>Status</h3>
        <div class="dev-btn-row">
          <button class="dev-btn" data-status="stressed">Stressed</button>
          <button class="dev-btn" data-status="anxious">Anxious</button>
          <button class="dev-btn" data-status="balanced">Balanced</button>
          <button class="dev-btn" data-status="zen">Zen</button>
          <button class="dev-btn" data-status="sleeping">Sleeping</button>
          <button class="dev-btn" data-status="gone">Gone</button>
        </div>
      </div>
    </div>
    <!-- GEAR ICON for DEV MENU -->
    <button id="devGear" title="Open Dev Menu" aria-label="Dev Menu">
      <svg viewBox="0 0 32 32"><circle cx="16" cy="16" r="5"/><g>
      <path d="M16 3v3"/><path d="M16 26v3"/><path d="M3 16h3"/><path d="M26 16h3"/>
      <path d="M7.2 7.2l2.1 2.1"/><path d="M22.7 22.7l2.1 2.1"/>
      <path d="M7.2 24.8l2.1-2.1"/><path d="M24.8 7.2l-2.1 2.1"/>
      </g></svg>
    </button>
  </div>
  <script>
    // Critter setup and animation
    const critterNames = ["critter1", "critter2", "critter3"];
    let currentCritterIdx = 0;
    let currentCritter = critterNames[0];
    const statuses = ["stressed", "anxious", "balanced", "zen", "sleeping", "gone"];
    let currentEvolution = 1; // still used for actual evolution logic (zen streak)
    let critterStatus = "balanced";
    let animFrame = 1, critterAnimInt = null;
    let zenStreakStart = null;

    function getStatusFromChecks() {
      return critterStatus;
    }

    function animateCritter() {
      let src = `img/${currentCritter}/${critterStatus}_${currentEvolution}_${animFrame}.png`;
      document.getElementById('critterImg').src = src;
      animFrame = animFrame === 1 ? 2 : 1;
    }
    function startCritterAnim() {
      if(critterAnimInt) clearInterval(critterAnimInt);
      animFrame = 1; animateCritter();
      critterAnimInt = setInterval(animateCritter, 650);
    }
    function selectCritter(idx) {
      currentCritterIdx = idx;
      currentCritter = critterNames[idx];
      currentEvolution = 1;
      zenStreakStart = null;
      animFrame = 1;
      updatePickerHighlight();
      startCritterAnim();
    }
    function updatePickerHighlight() {
      critterNames.forEach((name, i) => {
        const el = document.getElementById(`thumb-${name}`);
        if (el) el.classList.toggle("selected", i === currentCritterIdx);
      });
    }
    function showEvolutionMsg(msg) {
      let el = document.getElementById('evolutionMsg');
      el.innerHTML = msg; el.style.display = "block";
      setTimeout(()=>{ el.style.display="none"; }, 3300);
    }
    function handleZenStreak() {
      if(critterStatus !== "zen") { zenStreakStart = null; currentEvolution = 1; return;}
      let now = Date.now();
      if(!zenStreakStart) zenStreakStart = now;
      let days = Math.floor((now-zenStreakStart)/86400000);
      let evoTarget = 1 + Math.floor(days/7);
      if(evoTarget > currentEvolution) {
        currentEvolution = evoTarget;
        showEvolutionMsg(`Your Critter EVOLVED! ðŸŒ±<br>Stage ${currentEvolution}`);
      }
      if(currentEvolution > 3) currentEvolution = 3;
    }

    // BTC price & chart using only blockchain.info, always works
    let btcTries = 0;
    async function updateBTC() {
      try {
        let res = await fetch('https://blockchain.info/ticker');
        let data = await res.json();
        let price = data.USD.last;
        document.getElementById('btcPrice').textContent = "BTC: $" + price.toLocaleString(undefined, {minimumFractionDigits:2,maximumFractionDigits:2});
        document.getElementById('btcPrice').style.color = "#38ffe4";
        let chartUrl = 'https://quickchart.io/chart?c=' +
          encodeURIComponent(JSON.stringify({
            type:'sparkline',
            data:{datasets:[{data:[2,2.2,2,2.3,2.1,2.6,2.4,2.7,2.9,3,3.2,3.1,3.5,3.3,3.7,3.8,3.6,4,4.1,4,4.4,4.2,4.5,4.7,5,5.2,5,5.4,5.1]}]}, // Static for demo
            options:{
              elements:{point:{radius:0}},
              scales:{x:{display:false},y:{display:false}},
              plugins:{legend:{display:false}}
            }
          }));
        document.getElementById('btcChart').src = chartUrl;
        document.getElementById('btcChart').style.display = 'block';
        document.getElementById('chartError').style.display = 'none';
      } catch (e) {
        btcTries++;
        document.getElementById('btcPrice').textContent = "BTC: Unavailable";
        document.getElementById('btcPrice').style.color = "#e74c3c";
        document.getElementById('btcChart').style.display = 'none';
        document.getElementById('chartError').style.display = 'block';
        if (btcTries < 2) setTimeout(updateBTC, 1000 * btcTries);
      }
    }

    // DEV MENU logic - open by clicking gear, close as soon as a status is picked
    function openDevMenu() {
      document.getElementById('devMenu').style.display = 'flex';
    }
    function closeDevMenu() {
      document.getElementById('devMenu').style.display = 'none';
    }
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('critterImg').addEventListener('click',()=>{
        document.getElementById('critterImg').style.transform = "translateY(-28px) scale(1.1) rotate(-7deg)";
        setTimeout(()=>document.getElementById('critterImg').style.transform="", 220);
      });
      updatePickerHighlight();
      mainLoop();
      setInterval(mainLoop, 120*1000);

      // DEV: click gear icon for dev menu
      document.getElementById('devGear').addEventListener('click', function(e) {
        e.stopPropagation();
        openDevMenu();
      });

      // Dev status buttons
      document.querySelectorAll('.dev-btn[data-status]').forEach(btn => {
        btn.addEventListener('click', function() {
          critterStatus = btn.getAttribute('data-status');
          startCritterAnim();
          closeDevMenu();
        });
      });
    });

    function mainLoop() {
      critterStatus = getStatusFromChecks();
      handleZenStreak();
      startCritterAnim();
      updateBTC();
    }
  </script>
</body>
</html>
