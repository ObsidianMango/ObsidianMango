<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Space Block Breaker</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: none; user-select: none; }
        body { background: black; overflow: hidden; }
        canvas { display: block; position: absolute; top: 0; left: 0; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        let width = canvas.width = window.innerWidth;
        let height = canvas.height = window.innerHeight;
        let paddleWidth = width * 0.2, paddleHeight = 12, paddleX = (width - paddleWidth) / 2;
        let ballRadius = 10, ball = { x: width / 2, y: height - 50, dx: 0, dy: 0, speed: 6, power: false };
        let particles = [], powerUps = [], starfield = [], ballTrail = [];
        let blocks = [], indestructibleBlocks = [];
        const rows = 6, cols = 10, blockWidth = width / cols - 4, blockHeight = 30;
        let superBall = false, extendedPaddle = false, level = 1, gameStarted = false;

        function createBlocks() {
            blocks = [];
            indestructibleBlocks = [];
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    if (level > 1 && (r + c) % Math.floor(10 / level) === 0) {
                        indestructibleBlocks.push({ x: c * (blockWidth + 4) + 2, y: r * (blockHeight + 4) + 50 });
                    } else {
                        blocks.push({ x: c * (blockWidth + 4) + 2, y: r * (blockHeight + 4) + 50, status: true, color: `hsl(${Math.random() * 360}, 100%, 60%)` });
                    }
                }
            }
        }
        createBlocks();

        function createStarfield() {
            starfield = [];
            for (let i = 0; i < 100; i++) {
                starfield.push({ x: Math.random() * width, y: Math.random() * height, size: Math.random() * 2, speed: Math.random() * 3 + 1 });
            }
        }
        createStarfield();

        function drawStarfield() {
            ctx.fillStyle = "white";
            starfield.forEach(star => {
                ctx.fillRect(star.x, star.y, star.size, star.size);
                star.y += star.speed;
                if (star.y > height) star.y = 0;
            });
        }

        function drawPaddle() {
            ctx.fillStyle = "#0ff";
            ctx.fillRect(paddleX, height - paddleHeight - 10, paddleWidth, paddleHeight);
        }

        function drawBall() {
            ballTrail.push({ x: ball.x, y: ball.y, opacity: 1 });
            ballTrail = ballTrail.map(t => ({ ...t, opacity: t.opacity - 0.05 })).filter(t => t.opacity > 0);

            ballTrail.forEach(trail => {
                ctx.fillStyle = `rgba(255, 255, 255, ${trail.opacity})`;
                ctx.beginPath();
                ctx.arc(trail.x, trail.y, ballRadius * 0.8, 0, Math.PI * 2);
                ctx.fill();
            });

            ctx.fillStyle = ball.power ? "#f0f" : "#fff";
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ballRadius, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawBlocks() {
            blocks.forEach(block => {
                if (block.status) {
                    ctx.fillStyle = block.color;
                    ctx.fillRect(block.x, block.y, blockWidth, blockHeight);
                }
            });

            ctx.fillStyle = "#777";
            indestructibleBlocks.forEach(block => {
                ctx.fillRect(block.x, block.y, blockWidth, blockHeight);
            });
        }

        function moveBall() {
            if (!gameStarted) return;

            ball.x += ball.dx;
            ball.y += ball.dy;

            if (ball.x < ballRadius || ball.x > width - ballRadius) ball.dx *= -1;
            if (ball.y < ballRadius) ball.dy *= -1;
            if (ball.y > height) resetGame();

            if (ball.y > height - paddleHeight - 20 && ball.x > paddleX && ball.x < paddleX + paddleWidth) {
                ball.dy = -Math.abs(ball.dy);
                if (!gameStarted) gameStarted = true;
            }

            blocks.forEach((block, i) => {
                if (block.status && ball.x > block.x && ball.x < block.x + blockWidth && ball.y > block.y && ball.y < block.y + blockHeight) {
                    if (!superBall) ball.dy *= -1;
                    block.status = false;
                }
            });

            indestructibleBlocks.forEach(block => {
                if (ball.x > block.x && ball.x < block.x + blockWidth && ball.y > block.y && ball.y < block.y + blockHeight) {
                    ball.dy *= -1;
                }
            });

            if (blocks.every(block => !block.status)) {
                level++;
                createBlocks();
                resetBall();
            }
        }

        function resetBall() {
            ball.x = width / 2;
            ball.y = height - 50;
            ball.dx = 0;
            ball.dy = 0;
            gameStarted = false;
        }

        function resetGame() {
            level = 1;
            createBlocks();
            resetBall();
        }

        function update() {
            ctx.clearRect(0, 0, width, height);
            drawStarfield();
            drawPaddle();
            drawBall();
            drawBlocks();
            moveBall();
            requestAnimationFrame(update);
        }
        update();

        document.addEventListener("keydown", e => {
            if (e.key === " ") {
                if (!gameStarted) {
                    ball.dx = Math.random() > 0.5 ? 4 : -4;
                    ball.dy = -6;
                    gameStarted = true;
                }
            }
        });

        document.addEventListener("mousemove", e => paddleX = e.clientX - paddleWidth / 2);
        document.addEventListener("touchmove", e => paddleX = e.touches[0].clientX - paddleWidth / 2);
        document.addEventListener("click", () => {
            if (!gameStarted) {
                ball.dx = Math.random() > 0.5 ? 4 : -4;
                ball.dy = -6;
                gameStarted = true;
            }
        });
    </script>
</body>
</html>