<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>3D Cookie Biting</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>

<script type="module">
  import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.module.js';
  import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.150.1/examples/jsm/controls/OrbitControls.js';

  const cookieTextures = [
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAArklEQVR4nGP4////fwY8OnRqwAHMnJycOy9evSDB9+vXQHk6nBhR6PNmzYMIZ/+9//+MDDIUzMjCxZ8+exMDAgQYGBkZGRv7///2bN29gUHLly+oCRQUEBHbu3FkYGBj4kyZP4P+//1/hkYGBhgYGJIDgMP//f1GxP///+T0zZs2gcPi/AEiBGIgw8eP/5lqA4S/C+/evYJB4ED4/CiQBAogMPnz6+Dg4Ovy8vIgdx6bNm3jhw8f/gF3lAGmDeT79A+RNk/GAd3FQZhxwAAAAASUVORK5CYII=',
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAoElEQVR4nGP4////fwY8OnRqwAEU5ubm7LMnT9gwfv36YCH/8+fP4Dz+//8fzMwMG/v379/8GBQcwMp4+ffqAwu7du6B2Y8eOcGE6u7t7f+RkZGBcx/8B+4ePH0BH5Nh2ITbgdghEBhQUFB92HPPp0c6diw4SPbMsWMH+////FzCyZMn6jx8+HECABYBgeACFAgIGBj/AMeIFxA/OiCl4JRAYMEAAAoGBYdQuxpFQAAAABJRU5ErkJggg==',
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAm0lEQVR4nGP4////fwY8OnRqwAGsVFRU7L179wxfv35YMP79+7/ww8//w8FmZ2cjC/+/Pn/wYFBDIxMTH/pEmTiK0AwGAw2foLLmD9+vWMGjVqIDu4uLgfa9atgBQUFHTt2jUZXggggGf/D7AxGXs5c+YNDhw4ACFA4OBg7ODAgQPEA8dQYERhQ+gBgxS5LAEixE4QAAhAqRtENsiOrAAAAAElFTkSuQmCC',
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAqElEQVR4nGP4////fwY8OnRqwAGsKioq+ZMnT9gxY8a4AP7+/fv3//4O/v7+7y8vBzgA4yNDQ0Pf3///+8/fv359vXr1+fMAwMD/b179973w8MDA/v/+/YFAw7kZGCYGBgYXCiQGBsVERGG3ZsWcIAcOhQxeqPDKq04yKCg4OBvwB2g78AwvpVA0gZtoOIw9nQeYFCC8CqwKMHBwcDAwM3/Xr1/95pK3zwcoABAM2W/Gi4drx4AAAAASUVORK5CYII=',
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAANUlEQVR4nGP4////PwMxARMDgwENEB8Aa/++fQY8f/gfKr83mIdl4FqIow6YTqgkofACDYAIDhw4f/AEZgJXOwboEf6QAAAABJRU5ErkJggg=='
  ];

  let biteIndex = 0;
  let scene, camera, renderer, controls, cookieMesh;

  init();
  animate();

  function init() {
    scene = new THREE.Scene();

    camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(0, 0, 5);

    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Lights
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
    scene.add(ambientLight);

    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight.position.set(5, 5, 5);
    scene.add(directionalLight);

    // OrbitControls
    controls = new OrbitControls(camera, renderer.domElement);

    // Cookie geometry
    const geometry = new THREE.SphereGeometry(1, 32, 32);
    const texture = new THREE.TextureLoader().load(cookieTextures[biteIndex]);
    const material = new THREE.MeshStandardMaterial({
      map: texture,
      metalness: 0,
      roughness: 1
    });

    cookieMesh = new THREE.Mesh(geometry, material);
    scene.add(cookieMesh);

    // Click to progress bites
    document.addEventListener('click', onDocumentClick, false);
    window.addEventListener('resize', onWindowResize, false);
  }

  function onDocumentClick() {
    biteIndex++;
    if (biteIndex < cookieTextures.length) {
      const newTexture = new THREE.TextureLoader().load(cookieTextures[biteIndex]);
      cookieMesh.material.map = newTexture;
      cookieMesh.material.needsUpdate = true;
    } else {
      scene.remove(cookieMesh);
    }
  }

  function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  }

  function animate() {
    requestAnimationFrame(animate);
    if (cookieMesh) {
      cookieMesh.rotation.y += 0.01;
    }
    controls.update();
    renderer.render(scene, camera);
  }
</script>

</body>
</html>
